<!doctype html public "-//w3c//dtd html 4.0 transitional//en">
<html>
<head>
   <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
   <meta name="Author" content="Benjamin Franksen">
   <meta name="Description" content="Information about the EPICS caPutLog module.">
   <meta name="KeyWords" content="EPICS, CA, Logging">
   <title>EPICS CaPutLog Module</title>
</head>
<body text="#000000" bgcolor="#FFFFFF" link="#0000EE" vlink="#551A8B" alink="#FF0000">
<img SRC="epics.gif" width=101 ALT="EPICS" HSPACE=5 height=101 align=RIGHT>

<h1>EPICS CaPutLog Module</h1>

<dl>

<dt>Module Owner:</dt>

<dd><a href="mailto:benjamin.franksen@bessy.de">Benjamin Franksen</a></dd>

</dl>

<h2>What's it?</h2>

<p>CaPutLog is an EPICS support module that provides logging for Channel Access put operations. The current version works with EPICS 3.14.8.2 and later and is almost a complete re-write of the original (3.13 compatible) version that was written by V. Korobov (DESY). It is based on the generic iocLogClient that is part of the EPICS libCom. Starting a log server requires exactly the same steps as for the regular iocLogServer, except that you probably want to use a different port. On the IOC side there are three routines to be called from the iocShell. See Section Installation, below.</p>

<h2>Get it</h2>

<p>You can download a release from the links in the table below, or get the latest development version via <a href=http://www.darcs.net/>darcs</a>:</p>

<pre>
  darcs get http://www-csr.bessy.de/control/SoftDist/caPutLog/repo/caPutLog
</pre>

<table BORDER>

<tr ALIGN=CENTER>
<td><b>Module Version</b></td>
<td><b>EPICS Release</b></td>
<td><b>Filename</b></td>
<td><b>Release Notes</b></td>
</tr>

<tr>
<td><center>3.0</center></td>
<td><center>3.14.8.2</center></td>
<td><center><a href="caPutLog-3.0.tar.gz">caPutLog-3.0.tar.gz</a></center></td>
<td><center>n/a</center></td>
</tr>

<tr>
<td><center>3.1</center></td>
<td><center>3.14.8.2</center></td>
<td><center><a href="caPutLog-3.1.tar.gz">caPutLog-3.1.tar.gz</a></center></td>
<td><center><a href="caPutLog-3.1/docs/Changelog">Changelog</a></center></td>
</tr>

<tr>
<td><center>3.2</center></td>
<td><center>3.14.11</center></td>
<td><center><a href="caPutLog-3.2.tar.gz">caPutLog-3.2.tar.gz</a></center></td>
<td><center><a href="caPutLog-3.2/docs/Changelog">Changelog</a></center></td>
</tr>

</table>

<h2>Installation and Configuration</h2>

<p>Change the definition of <tt>EPICS_BASE</tt> in <tt>configure/RELEASE</tt> according to the location of epics base on the host, then (gnu-)<tt>make</tt>. Add the install directory to your IOC application's <tt>configure/RELEASE</tt>, and in the Makefile add <tt>caPutLog.dbd</tt> to your dbd includes and <tt>caPutLog</tt> to the libraries to link.</p>

In your IOC startup file add the command

<pre>
  caPutLogInit "host[:port]" [config]
</pre>

<p>where <tt>host</tt> (mandatory argument) is the IP address or host name of the log server and <tt>port</tt> is optional (the default is 7011). The environment variable <tt>EPICS_CA_PUT_LOG_ADDR</tt> is used if the first parameter to <tt>caPutLogInit</tt> is <tt>NULL</tt> or the empty string.</p>

The second (optional, default=0) argument should be one of

<pre>
  #define caPutLogNone        -1  /* no logging (disable) */
  #define caPutLogOnChange    0   /* log only on value change */
  #define caPutLogAll         1   /* log all puts */
</pre>

Make sure access security is enabled on the IOC by providing a suitable configuration file and load it with a call to <tt>asSetFilename(&lt;filename&gt;)</tt> before iocInit. Your configuration file should contain a TRAPWRITE rule. The following snippet can be used to enable read/write access and write trapping for everyone (i.e. unrestricted access):

<pre>
  ASG(DEFAULT) {
    RULE(1,READ)
    RULE(1,WRITE,TRAPWRITE)
  }
</pre>

<p><tt>caPutLogInit</tt> expects access security to be already running, so must be called <em>after</em> iocInit.</p>

<p>Other shell commands are:</p>

<dl>
  <dt><tt>caPutLogReconf config</tt></dt>
  <dd>Change configuration on-line. The argument is the same as in <tt>caPutLogInit</tt>.</dd>
</dl>

<dl>
  <dt><tt>caPutLogShow level</tt></dt>
  <dd>Show Here, level is the usual interest level (0, 1, or 2).</dd>
</dl>

<p>For the server you can use the same executable as for the regular IOC log server. You might want to start another instance with a dfferent port, though. However, you can also use the same log server instance (so that caput log messages and regular IOC log messages go into the same log file).</p>

<hr WIDTH="100%">

</body>
</html>
